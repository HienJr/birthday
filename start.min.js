const checkBtn=document.querySelector(".check");const playBtn=document.querySelector("#playBtn");const banner=document.querySelector(".banner");const question=document.querySelector(".question");const cake=document.querySelector(".cake");const image=document.querySelector(".image-wrap");const container=document.querySelector(".container");const data=["09/10/2001","09/10/2025","Ch√∫c m·ª´ng tu·ªïi 24","Ch√∫c m·ª´ng sinh nh·∫≠t","‚ù§Ô∏è","Love You","L√™ Th·ªã Kim T·ªët","Tiffany","Sinh nh·∫≠t vui v·∫ª","Happy Birthday üéÇ","üòò"];const depthLayers=[{scale:.6,speed:7,opacity:.5,zIndex:1},{scale:1,speed:6,opacity:.8,zIndex:2},{scale:1.4,speed:5,opacity:1,zIndex:3}];const usedPositions=[];const screenWidth=screen.width;const screenHeight=screen.height;function getRandomPosition(maxWidth,textWidth){let maxAttempts=50;let attempt=0;const padding=screenWidth>1025?80:30;while(attempt<maxAttempts){const x=Math.floor(Math.random()*(maxWidth-textWidth));let overLap=usedPositions.some(pos=>Math.abs(pos-x)<padding);if(!overLap){usedPositions.push(x);return x}attempt++}return null}function createDropText(text){const p=document.createElement("p");p.textContent=text;p.classList.add("drop-text");const layer=depthLayers[Math.floor(Math.random()*depthLayers.length)];p.style.color="white";p.style.fontSize=screenWidth>1024?`${24*layer.scale}px`:`${16*layer.scale}px`;p.style.animationDuration=`${layer.speed}s`;p.style.opacity=layer.opacity;p.style.zIndex=layer.zIndex;container.appendChild(p);const x=getRandomPosition(window.innerWidth,p.offsetWidth);if(x!==null){p.style.top=`-${p.offsetWidth}px`;p.style.left=`${x}px`;setTimeout(()=>{p.remove();usedPositions.splice(usedPositions.indexOf(x),1)},layer.speed*1e3)}else{p.remove()}}const dataLength=data.length;const bg=document.querySelector(".star-background");function createStar(){const start=document.createElement("div");start.className="star";start.style.width=`${Math.floor(Math.random()*3)+1}px`;start.style.height=`${Math.floor(Math.random()*3)+1}px`;start.style.left=`${Math.random()*screenWidth}px`;start.style.top=`${Math.random()*screenHeight}px`;start.style.animationDelay=`${Math.random()*5}s`;return start}function startDropText(){setInterval(()=>{const text=data[Math.floor(Math.random()*dataLength)];createDropText(text)});for(let i=0;i<240;i++){const start=createStar();bg.appendChild(start)}}class SliderImage{constructor(className){this.imgList=document.querySelector(className);if(!this.imgList){throw new Error(`Element with selector "${className}" not found.`)}this.originalSlides=Array.from(this.imgList.children);this.originalSlidesLength=this.originalSlides.length;this.slides=this.originalSlides.slice(0);this.items=screen.width>768?5:3;this.currentIndex=this.items;this.speed=1500;this.isAnimating=false;this.createTrack();this.updatePosition()}createTrack(){const cloneHead=this.slides.slice(-this.items).map(node=>node.cloneNode(true));const cloneTail=this.slides.slice(0,this.items).map(node=>node.cloneNode(true));this.slides=cloneHead.concat(this.slides.concat(cloneTail));this.imgList.innerHTML="";this.slides.forEach(slide=>{slide.style.width=`calc(100% / ${this.items})`;this.imgList.appendChild(slide)})}moveSlide(step){if(this.isAnimating)return;this.isAnimating=true;const length=this.slides.length;this.currentIndex+=step;setTimeout(()=>{if(this.currentIndex>=length-this.items){this.currentIndex=this.items;this.updatePosition(true)}else if(this.currentIndex<=0){this.currentIndex=this.originalSlidesLength;this.updatePosition(true)}this.isAnimating=false},this.speed);this.updatePosition()}updatePosition(instant=false){const offset=-(this.currentIndex*(100/this.items));this.imgList.style.transition=instant?"none":`transform ease ${this.speed}ms`;this.imgList.style.transform=screenHeight<769?`translate(${offset}%, -50%)`:`translateX(${offset}%)`}autoSlide(step){if(this.intervalId)clearInterval(this.intervalId);this.intervalId=setInterval(()=>{this.moveSlide(step)},this.speed)}}function sliderImage(){const top=new SliderImage(".image-top");const bot=new SliderImage(".image-bot");top.autoSlide(-1);bot.autoSlide(1)}const canvas=document.getElementById("canvas");const ctx=canvas.getContext("2d");class Confetti{constructor(x,y,directionX){this.x=x;this.y=y;this.size=Math.random()*6+3;this.color=`hsl(${Math.random()*360}, 100%, 60%)`;this.alpha=1;this.gravity=.05;this.rotation=Math.random()*Math.PI*2;this.rotationSpeed=(Math.random()-.5)*.2;const angle=directionX<x?-2.5:-.6;const speed=Math.random()*6+6;this.vx=speed*Math.cos(angle)+(directionX<x?-1:1)*Math.random()*2;this.vy=speed*Math.sin(angle)+Math.random()*-1}update(){this.vy+=this.gravity;this.x+=this.vx;this.y+=this.vy;this.rotation+=this.rotationSpeed;this.alpha-=.001}draw(){ctx.save();ctx.translate(this.x,this.y);ctx.rotate(this.rotation);ctx.globalAlpha=this.alpha;ctx.fillStyle=this.color;ctx.fillRect(-this.size/2,-this.size/2,this.size,this.size);ctx.restore();ctx.globalAlpha=1}}const confettiList=[];function shootConfetti(x,y){for(let i=0;i<35;i++){confettiList.push(new Confetti(x,y,Math.random()<.5?0:canvas.width))}}function animate(){canvas.width=window.innerWidth;canvas.height=window.innerHeight;ctx.clearRect(0,0,canvas.width,canvas.height);for(let i=confettiList.length-1;i>=0;i--){const confetti=confettiList[i];confetti.update();confetti.draw();if(confetti.alpha<=0||confetti.y>canvas.height){confettiList.splice(i,1)}}requestAnimationFrame(animate)}animate();const candle=document.querySelectorAll(".candle");const wick=document.querySelectorAll(".wick");const flame=document.querySelectorAll(".flame");async function startMic(){const stream=await navigator.mediaDevices.getUserMedia({audio:true});const audioContext=new(window.AudioContext||window.webkitAudioContext);const source=audioContext.createMediaStreamSource(stream);const analyser=audioContext.createAnalyser();let stopMic=false;analyser.fftSize=2048;const bufferLength=analyser.fftSize;const dataArray=new Uint8Array(bufferLength);source.connect(analyser);function detectBlow(){if(stopMic)return;analyser.getByteFrequencyData(dataArray);const average=dataArray.reduce((acc,val)=>acc+val,0)/bufferLength;const threshold=45;if(average>threshold){wick.forEach((item,index)=>{item.hidden=true});flame.forEach(item=>item.hidden=true);for(let i=0;i<15;i++){shootConfetti(0,0);shootConfetti(canvas.width,0);shootConfetti(0,canvas.height);shootConfetti(canvas.width,canvas.height)}candle.forEach(item=>{item.style.opacity=0;item.style.transition="opacity 3s"});setTimeout(()=>{image.style.display="none";cake.style.transition="transform 3s";cake.style.transform="translateY(999px)";startDropText()},3e3);stopMic=true}}setInterval(detectBlow,0)}image.hidden=false;sliderImage();console.log(screenHeight);if(screenHeight<769){const imgTop=document.querySelector(".image-top");const imgBot=document.querySelector(".image-bot");console.log(imgBot);imgTop.style.top="50%";imgBot.style.display="none"}playBtn.onclick=function(){banner.hidden=true;question.hidden=false;image.hidden=true;window.addEventListener("resize",()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight})};checkBtn.onclick=function(){const day=document.querySelector(".date");if(day.value==="2025-10-09"){alert("‚ö†Ô∏èH√£y th·ªïi v√†o c·ªïng s·∫°c!!!‚ö†Ô∏è");const audio=document.querySelector("#audio");audio.play();question.hidden=true;for(let i=0;i<10;i++){shootConfetti(0,canvas.height);shootConfetti(canvas.width,canvas.height)}cake.hidden=false;canvas.addEventListener("click",e=>shootConfetti(e.clientX,e.clientY));canvas.addEventListener("touchstart",e=>{const touch=e.touches[0];shootConfetti(touch.clientX,touch.clientY)});startMic()}else{Swal.fire({icon:"error",title:"Sai r·ªìi!!! üòíüòíüòí",text:"Nh·∫≠p l·∫°i ƒëi!"})}};